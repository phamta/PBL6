(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[323],{285:(e,t,r)=>{"use strict";r.d(t,{$:()=>d});var a=r(5155),s=r(2115),n=r(9708),o=r(2085),i=r(9434);let l=(0,o.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:r,variant:s,size:o,asChild:d=!1,...c}=e,u=d?n.DX:"button";return(0,a.jsx)(u,{className:(0,i.cn)(l({variant:s,size:o,className:r})),ref:t,...c})});d.displayName="Button"},731:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>k});var a=r(5155),s=r(2115),n=r(285),o=r(2523),i=r(9409),l=r(6695),d=r(6126),c=r(5127),u=r(4165),m=r(8979);let p=(0,r(9946).A)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var h=r(7580),g=r(7924),f=r(5525),v=r(2525),x=r(6671),y=r(3483);function j(e){let{children:t,requiredRole:r,requiredPermission:s,permission:n,fallback:o}=e,{user:i}=(0,y.A)();return!i||r&&i.role!==r?o||null:(0,a.jsx)(a.Fragment,{children:t})}var b=r(8497);let w={admin:"bg-red-100 text-red-800",user:"bg-blue-100 text-blue-800",student:"bg-green-100 text-green-800",specialist:"bg-purple-100 text-purple-800",manager:"bg-orange-100 text-orange-800",viewer:"bg-gray-100 text-gray-800",system:"bg-yellow-100 text-yellow-800"},N={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",banned:"bg-red-100 text-red-800"};function k(){let[e,t]=(0,s.useState)([]),[r,y]=(0,s.useState)(!0),[k,R]=(0,s.useState)(""),[S,C]=(0,s.useState)(""),[A,T]=(0,s.useState)(!1),[E,U]=(0,s.useState)(!1),[I,L]=(0,s.useState)(null),[P,_]=(0,s.useState)({email:"",fullName:"",password:"",role:"user",department:""}),{getRoleDisplayName:M,can:D}=(0,b.S)();(0,s.useEffect)(()=>{V()},[]);let V=async()=>{try{y(!0);let e=localStorage.getItem("token"),r=await fetch("http://localhost:3001/api/v1/users",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(r.ok){let e=await r.json();t(Array.isArray(e)?e:[])}else x.oR.error("Kh\xf4ng thể tải danh s\xe1ch người d\xf9ng"),t([])}catch(e){console.error("Error fetching users:",e),x.oR.error("Lỗi kết nối server"),t([])}finally{y(!1)}},z=async()=>{try{let e=localStorage.getItem("token"),t=await fetch("http://localhost:3001/api/v1/users",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(P)});if(t.ok)x.oR.success("Tạo người d\xf9ng th\xe0nh c\xf4ng"),T(!1),_({email:"",fullName:"",password:"",role:"user",department:""}),V();else{let e=await t.json();x.oR.error(e.message||"Kh\xf4ng thể tạo người d\xf9ng")}}catch(e){console.error("Error creating user:",e),x.oR.error("Lỗi kết nối server")}},O=async(e,t)=>{try{let r=localStorage.getItem("token");(await fetch("http://localhost:3001/api/v1/users/".concat(e,"/assign-role"),{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify({role:t})})).ok?(x.oR.success("Ph\xe2n quyền th\xe0nh c\xf4ng"),V()):x.oR.error("Kh\xf4ng thể ph\xe2n quyền")}catch(e){console.error("Error assigning role:",e),x.oR.error("Lỗi kết nối server")}},B=async e=>{if(confirm("Bạn c\xf3 chắc chắn muốn x\xf3a người d\xf9ng n\xe0y?"))try{let t=localStorage.getItem("token");(await fetch("http://localhost:3001/api/v1/users/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok?(x.oR.success("X\xf3a người d\xf9ng th\xe0nh c\xf4ng"),V()):x.oR.error("Kh\xf4ng thể x\xf3a người d\xf9ng")}catch(e){console.error("Error deleting user:",e),x.oR.error("Lỗi kết nối server")}},H=e.filter(e=>{let t=e.fullName.toLowerCase().includes(k.toLowerCase())||e.email.toLowerCase().includes(k.toLowerCase()),r=!S||e.role===S;return t&&r});return(0,a.jsx)(j,{permission:"user:read",children:(0,a.jsxs)("div",{className:"container mx-auto py-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Quản l\xfd Ph\xe2n quyền"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Quản l\xfd t\xe0i khoản người d\xf9ng v\xe0 ph\xe2n quyền hệ thống"})]}),(0,a.jsx)(j,{permission:"user:create",children:(0,a.jsxs)(u.lG,{open:A,onOpenChange:T,children:[(0,a.jsx)(u.zM,{asChild:!0,children:(0,a.jsxs)(n.$,{children:[(0,a.jsx)(p,{className:"h-4 w-4 mr-2"}),"Tạo t\xe0i khoản"]})}),(0,a.jsxs)(u.Cf,{children:[(0,a.jsx)(u.c7,{children:(0,a.jsx)(u.L3,{children:"Tạo t\xe0i khoản mới"})}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(m.J,{htmlFor:"email",children:"Email"}),(0,a.jsx)(o.p,{id:"email",type:"email",value:P.email,onChange:e=>_(t=>({...t,email:e.target.value}))})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(m.J,{htmlFor:"fullName",children:"Họ v\xe0 t\xean"}),(0,a.jsx)(o.p,{id:"fullName",value:P.fullName,onChange:e=>_(t=>({...t,fullName:e.target.value}))})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(m.J,{htmlFor:"password",children:"Mật khẩu"}),(0,a.jsx)(o.p,{id:"password",type:"password",value:P.password,onChange:e=>_(t=>({...t,password:e.target.value}))})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(m.J,{htmlFor:"role",children:"Vai tr\xf2"}),(0,a.jsxs)(i.l6,{value:P.role,onValueChange:e=>_(t=>({...t,role:e})),children:[(0,a.jsx)(i.bq,{children:(0,a.jsx)(i.yv,{})}),(0,a.jsxs)(i.gC,{children:[(0,a.jsx)(i.eb,{value:"user",children:"Người d\xf9ng cơ sở"}),(0,a.jsx)(i.eb,{value:"student",children:"Sinh vi\xean/Học vi\xean quốc tế"}),(0,a.jsx)(i.eb,{value:"specialist",children:"Chuy\xean vi\xean HTQT/KHCN&ĐN"}),(0,a.jsx)(i.eb,{value:"manager",children:"L\xe3nh đạo Ph\xf2ng"}),(0,a.jsx)(i.eb,{value:"viewer",children:"Người d\xf9ng tra cứu"}),(0,a.jsx)(j,{permission:"user:assign_role",children:(0,a.jsx)(i.eb,{value:"admin",children:"Admin CNTT"})})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(m.J,{htmlFor:"department",children:"Ph\xf2ng/Khoa"}),(0,a.jsx)(o.p,{id:"department",value:P.department,onChange:e=>_(t=>({...t,department:e.target.value}))})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(n.$,{variant:"outline",onClick:()=>T(!1),children:"Hủy"}),(0,a.jsx)(n.$,{onClick:z,children:"Tạo t\xe0i khoản"})]})]})]})})]}),(0,a.jsxs)(l.Zp,{children:[(0,a.jsx)(l.aR,{children:(0,a.jsxs)(l.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(h.A,{className:"h-4 w-4"}),"Danh s\xe1ch người d\xf9ng"]})}),(0,a.jsxs)(l.Wu,{children:[(0,a.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(g.A,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(o.p,{placeholder:"T\xecm kiếm theo t\xean hoặc email...",value:k,onChange:e=>R(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(i.l6,{value:S,onValueChange:C,children:[(0,a.jsx)(i.bq,{className:"w-48",children:(0,a.jsx)(i.yv,{placeholder:"Lọc theo vai tr\xf2"})}),(0,a.jsxs)(i.gC,{children:[(0,a.jsx)(i.eb,{value:"",children:"Tất cả"}),(0,a.jsx)(i.eb,{value:"admin",children:"Admin CNTT"}),(0,a.jsx)(i.eb,{value:"user",children:"Người d\xf9ng cơ sở"}),(0,a.jsx)(i.eb,{value:"student",children:"Sinh vi\xean/Học vi\xean"}),(0,a.jsx)(i.eb,{value:"specialist",children:"Chuy\xean vi\xean"}),(0,a.jsx)(i.eb,{value:"manager",children:"L\xe3nh đạo"}),(0,a.jsx)(i.eb,{value:"viewer",children:"Tra cứu"})]})]})]}),(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(c.XI,{children:[(0,a.jsx)(c.A0,{children:(0,a.jsxs)(c.Hj,{children:[(0,a.jsx)(c.nd,{children:"Người d\xf9ng"}),(0,a.jsx)(c.nd,{children:"Vai tr\xf2"}),(0,a.jsx)(c.nd,{children:"Ph\xf2ng/Khoa"}),(0,a.jsx)(c.nd,{children:"Trạng th\xe1i"}),(0,a.jsx)(c.nd,{children:"Ng\xe0y tạo"}),(0,a.jsx)(c.nd,{children:"Thao t\xe1c"})]})}),(0,a.jsx)(c.BF,{children:r?(0,a.jsx)(c.Hj,{children:(0,a.jsx)(c.nA,{colSpan:6,className:"text-center py-8",children:"Đang tải..."})}):0===H.length?(0,a.jsx)(c.Hj,{children:(0,a.jsx)(c.nA,{colSpan:6,className:"text-center py-8",children:"Kh\xf4ng c\xf3 dữ liệu"})}):H.map(e=>(0,a.jsxs)(c.Hj,{children:[(0,a.jsx)(c.nA,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:e.fullName}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:e.email})]})}),(0,a.jsx)(c.nA,{children:(0,a.jsx)(d.E,{className:w[e.role],children:M(e.role)})}),(0,a.jsx)(c.nA,{children:e.department||"-"}),(0,a.jsx)(c.nA,{children:(0,a.jsx)(d.E,{className:N[e.status],children:"active"===e.status?"Hoạt động":"inactive"===e.status?"Kh\xf4ng hoạt động":"Bị cấm"})}),(0,a.jsx)(c.nA,{children:new Date(e.createdAt).toLocaleDateString("vi-VN")}),(0,a.jsx)(c.nA,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(j,{permission:"user:assign_role",children:(0,a.jsxs)(i.l6,{value:e.role,onValueChange:t=>O(e.id,t),children:[(0,a.jsx)(i.bq,{className:"w-32",children:(0,a.jsx)(f.A,{className:"h-4 w-4 mr-1"})}),(0,a.jsxs)(i.gC,{children:[(0,a.jsx)(i.eb,{value:"user",children:"Người d\xf9ng"}),(0,a.jsx)(i.eb,{value:"student",children:"Sinh vi\xean"}),(0,a.jsx)(i.eb,{value:"specialist",children:"Chuy\xean vi\xean"}),(0,a.jsx)(i.eb,{value:"manager",children:"L\xe3nh đạo"}),(0,a.jsx)(i.eb,{value:"viewer",children:"Tra cứu"}),(0,a.jsx)(i.eb,{value:"admin",children:"Admin"})]})]})}),(0,a.jsx)(j,{permission:"user:delete",children:(0,a.jsx)(n.$,{variant:"ghost",size:"sm",onClick:()=>B(e.id),className:"text-red-600 hover:text-red-700",children:(0,a.jsx)(v.A,{className:"h-4 w-4"})})})]})})]},e.id))})]})})]})]})]})})}},2523:(e,t,r)=>{"use strict";r.d(t,{p:()=>o});var a=r(5155),s=r(2115),n=r(9434);let o=s.forwardRef((e,t)=>{let{className:r,type:s,...o}=e;return(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...o})});o.displayName="Input"},3483:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>c,A:()=>u});var a=r(5155),s=r(2115),n=r(5695);function o(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)e[a]=r[a]}return e}var i=function e(t,r){function a(e,a,s){if("undefined"!=typeof document){"number"==typeof(s=o({},r,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var n="";for(var i in s)s[i]&&(n+="; "+i,!0!==s[i]&&(n+="="+s[i].split(";")[0]));return document.cookie=e+"="+t.write(a,e)+n}}return Object.create({set:a,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],a={},s=0;s<r.length;s++){var n=r[s].split("="),o=n.slice(1).join("=");try{var i=decodeURIComponent(n[0]);if(a[i]=t.read(o,i),e===i)break}catch(e){}}return e?a[e]:a}},remove:function(e,t){a(e,"",o({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,o({},this.attributes,t))},withConverter:function(t){return e(o({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});let l=r(3464).A.create({baseURL:"http://localhost:3001/api/v1",timeout:1e4,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>{var t;return(null==(t=e.response)?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});let d=(0,s.createContext)(void 0);function c(e){let{children:t}=e,[r,o]=(0,s.useState)(null),[c,u]=(0,s.useState)(null),[m,p]=(0,s.useState)(!0);(0,n.useRouter)(),(0,s.useEffect)(()=>{(async()=>{let e=i.get("auth-token");if(e){u(e),l.defaults.headers.common.Authorization="Bearer ".concat(e);try{let e=await l.get("/users/profile");o(e.data)}catch(e){console.error("Failed to fetch user profile:",e),i.remove("auth-token"),u(null),delete l.defaults.headers.common.Authorization}}p(!1)})()},[]);let h=async(e,t)=>{try{let{access_token:r,user:a}=(await l.post("/auth/login",{email:e,password:t})).data;u(r),o(a),i.set("auth-token",r,{expires:7}),l.defaults.headers.common.Authorization="Bearer ".concat(r)}catch(e){throw e}},g=async()=>{if(c)try{let e=await l.get("/users/profile");o(e.data)}catch(e){console.error("Failed to refresh user:",e)}};return(0,a.jsx)(d.Provider,{value:{user:r,token:c,isLoading:m,login:h,logout:()=>{o(null),u(null),i.remove("auth-token"),delete l.defaults.headers.common.Authorization},refreshUser:g},children:t})}function u(){let e=(0,s.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4165:(e,t,r)=>{"use strict";r.d(t,{Cf:()=>m,L3:()=>h,c7:()=>p,lG:()=>l,zM:()=>d});var a=r(5155),s=r(2115),n=r(237),o=r(4416),i=r(9434);let l=n.bL,d=n.l9,c=n.ZL;n.bm;let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...s})});u.displayName=n.hJ.displayName;let m=s.forwardRef((e,t)=>{let{className:r,children:s,...l}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(n.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...l,children:[s,(0,a.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(o.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=n.UC.displayName;let p=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...r})};p.displayName="DialogHeader";let h=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",r),...s})});h.displayName=n.hE.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...s})}).displayName=n.VY.displayName},5127:(e,t,r)=>{"use strict";r.d(t,{A0:()=>i,BF:()=>l,Hj:()=>d,XI:()=>o,nA:()=>u,nd:()=>c});var a=r(5155),s=r(2115),n=r(9434);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",r),...s})})});o.displayName="Table";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",r),...s})});i.displayName="TableHeader";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",r),...s})});l.displayName="TableBody",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...s})}).displayName="TableFooter";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...s})});d.displayName="TableRow";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...s})});c.displayName="TableHead";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("td",{ref:t,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...s})});u.displayName="TableCell",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",r),...s})}).displayName="TableCaption"},5695:(e,t,r)=>{"use strict";var a=r(8999);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},5731:(e,t,r)=>{"use strict";r.d(t,{KB:()=>d,PE:()=>c,Sn:()=>o,ZQ:()=>l,vQ:()=>u});var a=r(3464);let s="http://localhost:3001/api/v1",n=a.A.create({baseURL:s,timeout:3e4,headers:{"Content-Type":"application/json"},withCredentials:!0});n.interceptors.request.use(e=>{var t;let r=localStorage.getItem("token");return r&&(e.headers.Authorization="Bearer ".concat(r)),console.log("\uD83D\uDE80 API Request: ".concat(null==(t=e.method)?void 0:t.toUpperCase()," ").concat(e.url)),e},e=>(console.error("❌ Request Error:",e),Promise.reject(e))),n.interceptors.response.use(e=>{var t;return console.log("✅ API Response: ".concat(null==(t=e.config.method)?void 0:t.toUpperCase()," ").concat(e.config.url," - ").concat(e.status)),e},e=>{var t;return console.error("❌ Response Error:",e),(null==(t=e.response)?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});let o={auth:{login:"/auth/login",logout:"/auth/logout",profile:"/auth/profile",refresh:"/auth/refresh"},admin:{users:"/admin/users",roles:"/admin/roles",systemLogs:"/admin/system-logs",statistics:"/admin/statistics"},mou:{base:"/mou",export:"/reports/mou/excel"},visa:{base:"/visa",export:"/reports/visa/excel"},visitor:{base:"/visitor",export:"/reports/visitor/excel"},translation:{base:"/translation",export:"/reports/translation/excel"},reports:{dashboard:"/reports/dashboard",export:"/reports/export"}},i={get:async(e,t)=>(await n.get(e,t)).data,post:async(e,t,r)=>(await n.post(e,t,r)).data},l={login:async e=>i.post(o.auth.login,e),logout:async()=>i.post(o.auth.logout),getProfile:async()=>i.get(o.auth.profile),refreshToken:async()=>i.post(o.auth.refresh)},d=(e,t)=>{let r=new URL(e,s);return t&&Object.entries(t).forEach(e=>{let[t,a]=e;r.searchParams.append(t,String(a))}),r.toString()},c=async(e,t)=>{let r=localStorage.getItem("token"),a=await fetch(d(e),{headers:{Authorization:"Bearer ".concat(r)}});if(a.ok){let e=await a.blob(),r=window.URL.createObjectURL(e),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(r),document.body.removeChild(s)}else throw Error("Download failed")},u={name:"Hệ thống Quản l\xfd Hợp t\xe1c Quốc tế",universityName:"Trường Đại học B\xe1ch Khoa Đ\xe0 Nẵng",version:"1.0.0",pagination:{defaultPageSize:10,maxPageSize:100}}},6126:(e,t,r)=>{"use strict";r.d(t,{E:()=>i});var a=r(5155);r(2115);var s=r(2085),n=r(9434);let o=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:r,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)(o({variant:r}),t),...s})}},6695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>o,aR:()=>i});var a=r(5155),s=r(2115),n=r(9434);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});o.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});l.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});c.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},7147:(e,t,r)=>{Promise.resolve().then(r.bind(r,731))},8497:(e,t,r)=>{"use strict";r.d(t,{S:()=>o,g:()=>s});var a=r(9323);let s={ADMIN:"admin",USER:"user",STUDENT:"student",SPECIALIST:"specialist",MANAGER:"manager",VIEWER:"viewer",SYSTEM:"system"},n={[s.ADMIN]:["user:create","user:read","user:update","user:delete","user:assign_role","system:config","system:backup","system:logs","data:view_all","report:view","report:export","report:stats","notification:manage","visa:create","visa:read","visa:update","visa:delete","visa:review","visa:approve","visa:reject","visa:assign","visa:export","mou:create","mou:read","mou:update","mou:delete","mou:review","mou:approve","mou:sign","mou:terminate","mou:assign","mou:export","translation:create","translation:read","translation:update","translation:delete","translation:review","translation:approve","translation:certify","visitor:create","visitor:read","visitor:update","visitor:delete","visitor:approve","visitor:export"],[s.USER]:["data:view_department","visa:create","visa:read","visa:update","mou:create","mou:read","mou:update","translation:create","translation:read","translation:update","visitor:create","visitor:read","visitor:update"],[s.STUDENT]:["data:view_own","visa:create","visa:read","visa:update"],[s.SPECIALIST]:["data:view_all","visa:read","visa:review","visa:assign","mou:read","mou:review","mou:assign","translation:read","translation:review","translation:certify","visitor:read","visitor:update","report:view","report:export"],[s.MANAGER]:["data:view_all","visa:read","visa:approve","visa:reject","visa:export","mou:read","mou:approve","mou:sign","mou:terminate","mou:export","translation:read","translation:approve","visitor:read","visitor:approve","visitor:export","report:view","report:export","report:stats"],[s.VIEWER]:["data:view_public","visa:read","mou:read","translation:read","visitor:read","report:view"],[s.SYSTEM]:["notification:send","data:view_all","visa:read","mou:read"]},o=()=>{let e=a._.getUser(),t=t=>!!(null==e?void 0:e.role)&&(n[e.role]||[]).includes(t),r=t=>{if(!(null==e?void 0:e.role))return!1;let r=n[e.role]||[];return t.some(e=>r.includes(e))};return{hasPermission:t,hasAnyPermission:r,hasAllPermissions:t=>{if(!(null==e?void 0:e.role))return!1;let r=n[e.role]||[];return t.every(e=>r.includes(e))},canAccessData:e=>{switch(e){case"own":return r(["data:view_own","data:view_department","data:view_all"]);case"department":return r(["data:view_department","data:view_all"]);case"all":return t("data:view_all");case"public":return r(["data:view_public","data:view_own","data:view_department","data:view_all"]);default:return!1}},canAccessModule:(e,r)=>t("".concat(e,":").concat(r)),getRoleDisplayName:e=>({[s.ADMIN]:"Admin CNTT",[s.USER]:"Người d\xf9ng cơ sở",[s.STUDENT]:"Sinh vi\xean/Học vi\xean quốc tế",[s.SPECIALIST]:"Chuy\xean vi\xean HTQT/KHCN&ĐN",[s.MANAGER]:"L\xe3nh đạo Ph\xf2ng",[s.VIEWER]:"Người d\xf9ng tra cứu",[s.SYSTEM]:"Hệ thống"})[e]||e||"Kh\xf4ng x\xe1c định",can:{createUser:()=>t("user:create"),manageUsers:()=>t("user:read"),assignRoles:()=>t("user:assign_role"),configureSystem:()=>t("system:config"),viewSystemLogs:()=>t("system:logs"),createMOU:()=>t("mou:create"),viewMOU:()=>t("mou:read"),editMOU:()=>t("mou:update"),deleteMOU:()=>t("mou:delete"),reviewMOU:()=>t("mou:review"),approveMOU:()=>t("mou:approve"),signMOU:()=>t("mou:sign"),terminateMOU:()=>t("mou:terminate"),exportMOU:()=>t("mou:export"),createVisa:()=>t("visa:create"),viewVisa:()=>t("visa:read"),editVisa:()=>t("visa:update"),deleteVisa:()=>t("visa:delete"),reviewVisa:()=>t("visa:review"),approveVisa:()=>t("visa:approve"),rejectVisa:()=>t("visa:reject"),exportVisa:()=>t("visa:export"),createTranslation:()=>t("translation:create"),viewTranslation:()=>t("translation:read"),editTranslation:()=>t("translation:update"),deleteTranslation:()=>t("translation:delete"),reviewTranslation:()=>t("translation:review"),approveTranslation:()=>t("translation:approve"),certifyTranslation:()=>t("translation:certify"),createVisitor:()=>t("visitor:create"),viewVisitor:()=>t("visitor:read"),editVisitor:()=>t("visitor:update"),deleteVisitor:()=>t("visitor:delete"),approveVisitor:()=>t("visitor:approve"),exportVisitor:()=>t("visitor:export"),viewReports:()=>t("report:view"),exportReports:()=>t("report:export"),viewStatistics:()=>t("report:stats")},userRole:null==e?void 0:e.role,isAdmin:(null==e?void 0:e.role)===s.ADMIN,isUser:(null==e?void 0:e.role)===s.USER,isStudent:(null==e?void 0:e.role)===s.STUDENT,isSpecialist:(null==e?void 0:e.role)===s.SPECIALIST,isManager:(null==e?void 0:e.role)===s.MANAGER,isViewer:(null==e?void 0:e.role)===s.VIEWER,isSystem:(null==e?void 0:e.role)===s.SYSTEM}}},8979:(e,t,r)=>{"use strict";r.d(t,{J:()=>c});var a=r(5155),s=r(2115),n=r(3655),o=s.forwardRef((e,t)=>(0,a.jsx)(n.sG.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null==(r=e.onMouseDown)||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));o.displayName="Label";var i=r(2085),l=r(9434);let d=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(o,{ref:t,className:(0,l.cn)(d(),r),...s})});c.displayName=o.displayName},9323:(e,t,r)=>{"use strict";r.d(t,{_:()=>s});var a=r(5731);let s={login:async e=>{try{console.log("\uD83D\uDD11 Attempting login...",{email:e.email});let t=await a.ZQ.login(e);if(t.access_token&&t.user)return s.setToken(t.access_token),s.setUser(t.user),console.log("✅ Login successful"),{success:!0,data:t,message:"Login successful"};return console.log("❌ Login failed: Invalid response format"),{success:!1,message:"Invalid response from server"}}catch(e){var t,r,n,o;return console.error("❌ Login error:",e),{success:!1,message:(null==(r=e.response)||null==(t=r.data)?void 0:t.message)||e.message||"Login failed",errors:(null==(o=e.response)||null==(n=o.data)?void 0:n.errors)||[e.message]}}},setToken:e=>{localStorage.setItem("token",e),document.cookie="token=".concat(e,"; path=/; max-age=86400")},getToken:()=>localStorage.getItem("token"),removeToken:()=>{localStorage.removeItem("token"),document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT"},setUser:e=>{localStorage.setItem("user",JSON.stringify(e)),document.cookie="user=".concat(encodeURIComponent(JSON.stringify(e)),"; path=/; max-age=86400")},getUser:()=>{{let e=localStorage.getItem("user");return e?JSON.parse(e):null}},removeUser:()=>{localStorage.removeItem("user"),document.cookie="user=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT"},isAuthenticated:()=>!!localStorage.getItem("token"),requireAuth:()=>({isLoading:!1,user:null}),hasRole:(e,t)=>t===e||"admin"===t,hasPermission:(e,t)=>"admin"===t,mockLogin:e=>{let t="mock_token_"+Date.now();s.setToken(t),s.setUser({id:1,username:"demo_user",email:"demo@example.com",role:e,name:"Demo User"})},logout:()=>{s.removeToken(),s.removeUser(),window.location.href="/login"}}},9409:(e,t,r)=>{"use strict";r.d(t,{bq:()=>m,eb:()=>f,gC:()=>g,l6:()=>c,yv:()=>u});var a=r(5155),s=r(2115),n=r(5713),o=r(6474),i=r(7863),l=r(5196),d=r(9434);let c=n.bL;n.YJ;let u=n.WT,m=s.forwardRef((e,t)=>{let{className:r,children:s,...i}=e;return(0,a.jsxs)(n.l9,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...i,children:[s,(0,a.jsx)(n.In,{asChild:!0,children:(0,a.jsx)(o.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=n.l9.displayName;let p=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.PP,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",r),...s,children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})});p.displayName=n.PP.displayName;let h=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.wn,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",r),...s,children:(0,a.jsx)(o.A,{className:"h-4 w-4"})})});h.displayName=n.wn.displayName;let g=s.forwardRef((e,t)=>{let{className:r,children:s,position:o="popper",...i}=e;return(0,a.jsx)(n.ZL,{children:(0,a.jsxs)(n.UC,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===o&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:o,...i,children:[(0,a.jsx)(p,{}),(0,a.jsx)(n.LM,{className:(0,d.cn)("p-1","popper"===o&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,a.jsx)(h,{})]})})});g.displayName=n.UC.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.JU,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...s})}).displayName=n.JU.displayName;let f=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsxs)(n.q7,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...o,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.VF,{children:(0,a.jsx)(l.A,{className:"h-4 w-4"})})}),(0,a.jsx)(n.p4,{children:s})]})});f.displayName=n.q7.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",r),...s})}).displayName=n.wv.displayName},9434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var a=r(2596),s=r(9688);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}}},e=>{e.O(0,[3464,3455,2688,9801,6671,2320,8441,5964,7358],()=>e(e.s=7147)),_N_E=e.O()}]);