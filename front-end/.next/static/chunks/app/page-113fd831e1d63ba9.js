(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{3792:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l});var r=a(5155),o=a(2115),s=a(5695),i=a(9323),n=a(8497);function l(){let e=(0,s.useRouter)();return(0,o.useEffect)(()=>{if(i._.isAuthenticated()){let t=i._.getUser();switch(null==t?void 0:t.role){case n.g.ADMIN:case n.g.USER:case n.g.STUDENT:case n.g.SPECIALIST:case n.g.MANAGER:case n.g.VIEWER:default:e.push("/dashboard")}}else e.push("/login")},[e]),(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Đang tải..."})]})})}},4305:(e,t,a)=>{Promise.resolve().then(a.bind(a,3792))},5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},5731:(e,t,a)=>{"use strict";a.d(t,{KB:()=>u,PE:()=>c,Sn:()=>i,ZQ:()=>l,vQ:()=>d});var r=a(3464);let o="http://localhost:3001/api/v1",s=r.A.create({baseURL:o,timeout:3e4,headers:{"Content-Type":"application/json"},withCredentials:!0});s.interceptors.request.use(e=>{var t;let a=localStorage.getItem("token");return a&&(e.headers.Authorization="Bearer ".concat(a)),console.log("\uD83D\uDE80 API Request: ".concat(null==(t=e.method)?void 0:t.toUpperCase()," ").concat(e.url)),e},e=>(console.error("❌ Request Error:",e),Promise.reject(e))),s.interceptors.response.use(e=>{var t;return console.log("✅ API Response: ".concat(null==(t=e.config.method)?void 0:t.toUpperCase()," ").concat(e.config.url," - ").concat(e.status)),e},e=>{var t;return console.error("❌ Response Error:",e),(null==(t=e.response)?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});let i={auth:{login:"/auth/login",logout:"/auth/logout",profile:"/auth/profile",refresh:"/auth/refresh"},admin:{users:"/admin/users",roles:"/admin/roles",systemLogs:"/admin/system-logs",statistics:"/admin/statistics"},mou:{base:"/mou",export:"/reports/mou/excel"},visa:{base:"/visa",export:"/reports/visa/excel"},visitor:{base:"/visitor",export:"/reports/visitor/excel"},translation:{base:"/translation",export:"/reports/translation/excel"},reports:{dashboard:"/reports/dashboard",export:"/reports/export"}},n={get:async(e,t)=>(await s.get(e,t)).data,post:async(e,t,a)=>(await s.post(e,t,a)).data},l={login:async e=>n.post(i.auth.login,e),logout:async()=>n.post(i.auth.logout),getProfile:async()=>n.get(i.auth.profile),refreshToken:async()=>n.post(i.auth.refresh)},u=(e,t)=>{let a=new URL(e,o);return t&&Object.entries(t).forEach(e=>{let[t,r]=e;a.searchParams.append(t,String(r))}),a.toString()},c=async(e,t)=>{let a=localStorage.getItem("token"),r=await fetch(u(e),{headers:{Authorization:"Bearer ".concat(a)}});if(r.ok){let e=await r.blob(),a=window.URL.createObjectURL(e),o=document.createElement("a");o.href=a,o.download=t,document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(a),document.body.removeChild(o)}else throw Error("Download failed")},d={name:"Hệ thống Quản l\xfd Hợp t\xe1c Quốc tế",universityName:"Trường Đại học B\xe1ch Khoa Đ\xe0 Nẵng",version:"1.0.0",pagination:{defaultPageSize:10,maxPageSize:100}}},8497:(e,t,a)=>{"use strict";a.d(t,{S:()=>i,g:()=>o});var r=a(9323);let o={ADMIN:"admin",USER:"user",STUDENT:"student",SPECIALIST:"specialist",MANAGER:"manager",VIEWER:"viewer",SYSTEM:"system"},s={[o.ADMIN]:["user:create","user:read","user:update","user:delete","user:assign_role","system:config","system:backup","system:logs","data:view_all","report:view","report:export","report:stats","notification:manage","visa:create","visa:read","visa:update","visa:delete","visa:review","visa:approve","visa:reject","visa:assign","visa:export","mou:create","mou:read","mou:update","mou:delete","mou:review","mou:approve","mou:sign","mou:terminate","mou:assign","mou:export","translation:create","translation:read","translation:update","translation:delete","translation:review","translation:approve","translation:certify","visitor:create","visitor:read","visitor:update","visitor:delete","visitor:approve","visitor:export"],[o.USER]:["data:view_department","visa:create","visa:read","visa:update","mou:create","mou:read","mou:update","translation:create","translation:read","translation:update","visitor:create","visitor:read","visitor:update"],[o.STUDENT]:["data:view_own","visa:create","visa:read","visa:update"],[o.SPECIALIST]:["data:view_all","visa:read","visa:review","visa:assign","mou:read","mou:review","mou:assign","translation:read","translation:review","translation:certify","visitor:read","visitor:update","report:view","report:export"],[o.MANAGER]:["data:view_all","visa:read","visa:approve","visa:reject","visa:export","mou:read","mou:approve","mou:sign","mou:terminate","mou:export","translation:read","translation:approve","visitor:read","visitor:approve","visitor:export","report:view","report:export","report:stats"],[o.VIEWER]:["data:view_public","visa:read","mou:read","translation:read","visitor:read","report:view"],[o.SYSTEM]:["notification:send","data:view_all","visa:read","mou:read"]},i=()=>{let e=r._.getUser(),t=t=>!!(null==e?void 0:e.role)&&(s[e.role]||[]).includes(t),a=t=>{if(!(null==e?void 0:e.role))return!1;let a=s[e.role]||[];return t.some(e=>a.includes(e))};return{hasPermission:t,hasAnyPermission:a,hasAllPermissions:t=>{if(!(null==e?void 0:e.role))return!1;let a=s[e.role]||[];return t.every(e=>a.includes(e))},canAccessData:e=>{switch(e){case"own":return a(["data:view_own","data:view_department","data:view_all"]);case"department":return a(["data:view_department","data:view_all"]);case"all":return t("data:view_all");case"public":return a(["data:view_public","data:view_own","data:view_department","data:view_all"]);default:return!1}},canAccessModule:(e,a)=>t("".concat(e,":").concat(a)),getRoleDisplayName:e=>({[o.ADMIN]:"Admin CNTT",[o.USER]:"Người d\xf9ng cơ sở",[o.STUDENT]:"Sinh vi\xean/Học vi\xean quốc tế",[o.SPECIALIST]:"Chuy\xean vi\xean HTQT/KHCN&ĐN",[o.MANAGER]:"L\xe3nh đạo Ph\xf2ng",[o.VIEWER]:"Người d\xf9ng tra cứu",[o.SYSTEM]:"Hệ thống"})[e]||e||"Kh\xf4ng x\xe1c định",can:{createUser:()=>t("user:create"),manageUsers:()=>t("user:read"),assignRoles:()=>t("user:assign_role"),configureSystem:()=>t("system:config"),viewSystemLogs:()=>t("system:logs"),createMOU:()=>t("mou:create"),viewMOU:()=>t("mou:read"),editMOU:()=>t("mou:update"),deleteMOU:()=>t("mou:delete"),reviewMOU:()=>t("mou:review"),approveMOU:()=>t("mou:approve"),signMOU:()=>t("mou:sign"),terminateMOU:()=>t("mou:terminate"),exportMOU:()=>t("mou:export"),createVisa:()=>t("visa:create"),viewVisa:()=>t("visa:read"),editVisa:()=>t("visa:update"),deleteVisa:()=>t("visa:delete"),reviewVisa:()=>t("visa:review"),approveVisa:()=>t("visa:approve"),rejectVisa:()=>t("visa:reject"),exportVisa:()=>t("visa:export"),createTranslation:()=>t("translation:create"),viewTranslation:()=>t("translation:read"),editTranslation:()=>t("translation:update"),deleteTranslation:()=>t("translation:delete"),reviewTranslation:()=>t("translation:review"),approveTranslation:()=>t("translation:approve"),certifyTranslation:()=>t("translation:certify"),createVisitor:()=>t("visitor:create"),viewVisitor:()=>t("visitor:read"),editVisitor:()=>t("visitor:update"),deleteVisitor:()=>t("visitor:delete"),approveVisitor:()=>t("visitor:approve"),exportVisitor:()=>t("visitor:export"),viewReports:()=>t("report:view"),exportReports:()=>t("report:export"),viewStatistics:()=>t("report:stats")},userRole:null==e?void 0:e.role,isAdmin:(null==e?void 0:e.role)===o.ADMIN,isUser:(null==e?void 0:e.role)===o.USER,isStudent:(null==e?void 0:e.role)===o.STUDENT,isSpecialist:(null==e?void 0:e.role)===o.SPECIALIST,isManager:(null==e?void 0:e.role)===o.MANAGER,isViewer:(null==e?void 0:e.role)===o.VIEWER,isSystem:(null==e?void 0:e.role)===o.SYSTEM}}},9323:(e,t,a)=>{"use strict";a.d(t,{_:()=>o});var r=a(5731);let o={login:async e=>{try{console.log("\uD83D\uDD11 Attempting login...",{email:e.email});let t=await r.ZQ.login(e);if(t.access_token&&t.user)return o.setToken(t.access_token),o.setUser(t.user),console.log("✅ Login successful"),{success:!0,data:t,message:"Login successful"};return console.log("❌ Login failed: Invalid response format"),{success:!1,message:"Invalid response from server"}}catch(e){var t,a,s,i;return console.error("❌ Login error:",e),{success:!1,message:(null==(a=e.response)||null==(t=a.data)?void 0:t.message)||e.message||"Login failed",errors:(null==(i=e.response)||null==(s=i.data)?void 0:s.errors)||[e.message]}}},setToken:e=>{localStorage.setItem("token",e),document.cookie="token=".concat(e,"; path=/; max-age=86400")},getToken:()=>localStorage.getItem("token"),removeToken:()=>{localStorage.removeItem("token"),document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT"},setUser:e=>{localStorage.setItem("user",JSON.stringify(e)),document.cookie="user=".concat(encodeURIComponent(JSON.stringify(e)),"; path=/; max-age=86400")},getUser:()=>{{let e=localStorage.getItem("user");return e?JSON.parse(e):null}},removeUser:()=>{localStorage.removeItem("user"),document.cookie="user=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT"},isAuthenticated:()=>!!localStorage.getItem("token"),requireAuth:()=>({isLoading:!1,user:null}),hasRole:(e,t)=>t===e||"admin"===t,hasPermission:(e,t)=>"admin"===t,mockLogin:e=>{let t="mock_token_"+Date.now();o.setToken(t),o.setUser({id:1,username:"demo_user",email:"demo@example.com",role:e,name:"Demo User"})},logout:()=>{o.removeToken(),o.removeUser(),window.location.href="/login"}}}},e=>{e.O(0,[3464,8441,5964,7358],()=>e(e.s=4305)),_N_E=e.O()}]);